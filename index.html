<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Harry Copeman</title>
  <link rel="stylesheet" href="assets/css/gallery.css">
  <style>
    #about-modal {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s cubic-bezier(.4,0,.2,1);
    }
    #about-modal.open {
      opacity: 1;
      pointer-events: auto;
    }
    #about-modal {
      /* overlay styles already inline */
    }
    #about-modal-content {
      transform: scale(0.97) translateY(24px);
      opacity: 0;
      transition: opacity 0.35s cubic-bezier(.4,0,.2,1), transform 0.35s cubic-bezier(.4,0,.2,1);
    }
    #about-modal.open #about-modal-content {
      transform: scale(1) translateY(0);
      opacity: 1;
    }
    .carousel-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255,255,255,0.8);
      border: none;
      font-size: 2.5rem;
      cursor: pointer;
      z-index: 10;
      padding: 0.2em 0.5em;
      border-radius: 50%;
      transition: background 0.2s;
    }
    .carousel-arrow.left {
      left: 1vw;
    }
    .carousel-arrow.right {
      right: 1vw;
    }
    .carousel-arrow:hover {
      background: rgba(200,200,200,0.95);
    }
    .carousel-viewport,
    .carousel-viewport * {
      cursor: pointer;
    }
    .carousel-viewport.left-hover,
    .carousel-viewport.left-hover * {
      cursor: w-resize !important;
    }
    .carousel-viewport.right-hover,
    .carousel-viewport.right-hover * {
      cursor: e-resize !important;
    }
  </style>
</head>
<body>
  <header class="gallery-header">
    <span class="gallery-time" id="gallery-time"></span>
    <div class="gallery-title-block">
      <h1>Harry Copeman</h1>
      <p>Interface Designer in New York; <a href="#" id="about-link" class="about-link">About</a></p>
    </div>
    <div class="gallery-theme-toggle">
      <button id="light-toggle" class="active">Light</button>
      <button id="dark-toggle">Dark</button>
    </div>
  </header>
  <main class="gallery-main">
    <div class="carousel-viewport">
      <button class="carousel-arrow left" aria-label="Previous slide" tabindex="-1" style="opacity:0;pointer-events:none;position:absolute;left:0;top:0;width:50%;height:100%;background:none;border:none;"></button>
      <div class="carousel-track">
        <!-- Slides will be rendered here by JS -->
      </div>
      <button class="carousel-arrow right" aria-label="Next slide" tabindex="-1" style="opacity:0;pointer-events:none;position:absolute;right:0;top:0;width:50%;height:100%;background:none;border:none;"></button>
    </div>
  </main>
  <nav class="gallery-nav">
    <button class="gallery-nav-btn active">2022</button>
    <button class="gallery-nav-btn" disabled>2021</button>
    <button class="gallery-nav-btn" disabled>2020</button>
    <button class="gallery-nav-btn" disabled>2019</button>
  </nav>
  <div id="about-modal">
    <div id="about-modal-content">
      <button id="about-close" style="display:block;margin-bottom:24px;padding:8px 20px;font-size:16px;border-radius:8px;border:none;background:#eee;cursor:pointer;">Close</button>
      <p class="about-modal-bio">I'm a designer in New York with over a decade of experience working on consumer products. Originally from the UK, I left college to join Dropbox, and at 18 became Facebook's youngest employee. I then joined Farewill (acquired) as their founding designer, before opening the London office of Bakken & Baeck.<br><br>Today, I'm leading design at Cosmos, a platform for creatives to collect and curate inspiration. Before this, I led Artificial Intelligence and Discovery at Shop, and worked on creation tools at Universe.</p>
      <div class="about-modal-links">
        <a href="https://cosmos.so" target="_blank" class="about-link-row">Cosmos <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle;"><path d="M3.5 3C3.22386 3 3 3.22386 3 3.5C3 3.77614 3.22386 4 3.5 4V3ZM8.5 3.5H9C9 3.22386 8.77614 3 8.5 3V3.5ZM8 8.5C8 8.77614 8.22386 9 8.5 9C8.77614 9 9 8.77614 9 8.5H8ZM2.64645 8.64645C2.45118 8.84171 2.45118 9.15829 2.64645 9.35355C2.84171 9.54882 3.15829 9.54882 3.35355 9.35355L2.64645 8.64645ZM3.5 4H8.5V3H3.5V4ZM8 3.5V8.5H9V3.5H8ZM8.14645 3.14645L2.64645 8.64645L3.35355 9.35355L8.85355 3.85355L8.14645 3.14645Z" fill="currentColor"/></svg></a>
        <a href="https://www.linkedin.com/in/harrycopeman/" target="_blank" class="about-link-row">LinkedIn <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle;"><path d="M3.5 3C3.22386 3 3 3.22386 3 3.5C3 3.77614 3.22386 4 3.5 4V3ZM8.5 3.5H9C9 3.22386 8.77614 3 8.5 3V3.5ZM8 8.5C8 8.77614 8.22386 9 8.5 9C8.77614 9 9 8.77614 9 8.5H8ZM2.64645 8.64645C2.45118 8.84171 2.45118 9.15829 2.64645 9.35355C2.84171 9.54882 3.15829 9.54882 3.35355 9.35355L2.64645 8.64645ZM3.5 4H8.5V3H3.5V4ZM8 3.5V8.5H9V3.5H8ZM8.14645 3.14645L2.64645 8.64645L3.35355 9.35355L8.85355 3.85355L8.14645 3.14645Z" fill="currentColor"/></svg></a>
        <a href="mailto:harry@copeman.co" class="about-link-row">Email <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle;"><path d="M3.5 3C3.22386 3 3 3.22386 3 3.5C3 3.77614 3.22386 4 3.5 4V3ZM8.5 3.5H9C9 3.22386 8.77614 3 8.5 3V3.5ZM8 8.5C8 8.77614 8.22386 9 8.5 9C8.77614 9 9 8.77614 9 8.5H8ZM2.64645 8.64645C2.45118 8.84171 2.45118 9.15829 2.64645 9.35355C2.84171 9.54882 3.15829 9.54882 3.35355 9.35355L2.64645 8.64645ZM3.5 4H8.5V3H3.5V4ZM8 3.5V8.5H9V3.5H8ZM8.14645 3.14645L2.64645 8.64645L3.35355 9.35355L8.85355 3.85355L8.14645 3.14645Z" fill="currentColor"/></svg></a>
      </div>
    </div>
  </div>
  <script>
// Slide data from previous implementation
const slides = [
  {
    type: 'video',
    src: 'assets/vid/shop-2.mp4',
    year: '2024',
    caption: 'Led varying projects at Shop including a full redesign, a new homefeed, and AI strategy',
    alt: 'Shop redesign video'
  },
  {
    type: 'image',
    src: 'assets/img/universe-2.png',
    year: '2023',
    caption: 'Led a redesign of the Universe editor experience, winner of the 2023 Apple Design Award',
    alt: 'Universe editor redesign'
  },
  {
    type: 'video',
    src: 'assets/vid/ruter-screen.mp4',
    year: '2022',
    caption: 'Led a redesign for Norways public transportation company',
    alt: 'Ruter redesign video'
  },
  {
    type: 'image',
    src: 'assets/img/bb-office.jpeg',
    year: '2020',
    caption: 'Founded the London office for Bakken & Bæck',
    alt: 'Bakken & Bæck London office'
  },
  {
    type: 'image',
    src: 'assets/img/kron-2.png',
    year: '2019',
    caption: 'Designed Kron, Norways #1 finance app',
    alt: 'Kron finance app design'
  },
  {
    type: 'image',
    src: 'assets/img/farewill.png',
    year: '2017',
    caption: 'Founding designer at Farewill (acquired), raising over £1B for charity',
    alt: 'Farewill founding designer'
  },
  {
    type: 'image',
    src: 'assets/img/insta2.png',
    year: '2016',
    caption: 'Designed product tagging across Facebook and Instagram',
    alt: 'Instagram product tagging'
  },
  {
    type: 'image',
    src: 'assets/img/devices.png',
    year: '2015',
    caption: 'Part of the small team that launched Facebook design resources',
    alt: 'Facebook design resources'
  },
  {
    type: 'image',
    src: 'assets/img/mailbox.png',
    year: '2014',
    caption: 'Design and prototypes at Mailbox',
    alt: 'Mailbox design and prototypes'
  }
];

let current = 0;

function renderSlides() {
  const track = document.querySelector('.carousel-track');
  track.innerHTML = '';
  slides.forEach((slide, idx) => {
    const slideDiv = document.createElement('div');
    slideDiv.className = 'carousel-slide';
    slideDiv.setAttribute('data-index', idx);
    let el;
    if (slide.type === 'image') {
      el = document.createElement('img');
      el.src = slide.src;
      el.alt = slide.alt;
    } else if (slide.type === 'video') {
      el = document.createElement('video');
      el.src = slide.src;
      el.autoplay = true;
      el.muted = true;
      el.loop = true;
      el.playsInline = true;
      el.setAttribute('aria-label', slide.alt);
    }
    slideDiv.appendChild(el);
    // Add caption under media
    const captionDiv = document.createElement('div');
    captionDiv.className = 'carousel-caption';
    const yearSpan = document.createElement('span');
    yearSpan.className = 'gallery-year';
    yearSpan.textContent = slide.year;
    const descSpan = document.createElement('span');
    descSpan.className = 'gallery-desc';
    descSpan.textContent = slide.caption;
    captionDiv.appendChild(yearSpan);
    captionDiv.appendChild(descSpan);
    slideDiv.appendChild(captionDiv);
    track.appendChild(slideDiv);
  });
}

function updateCarousel(animate = true) {
  const track = document.querySelector('.carousel-track');
  const slidesEls = Array.from(track.children);
  const slide = slidesEls[current];
  if (!slide) return;
  const viewport = document.querySelector('.carousel-viewport');
  // Calculate the left offset of the slide relative to the track
  const slideRect = slide.getBoundingClientRect();
  const trackRect = track.getBoundingClientRect();
  const viewportRect = viewport.getBoundingClientRect();
  // The center of the slide relative to the track
  const slideCenterInTrack = slide.offsetLeft + slide.offsetWidth / 2;
  // The center of the viewport relative to the track
  const viewportCenterInTrack = (viewportRect.width) / 2;
  // The offset needed to center the slide
  const offset = viewportCenterInTrack - slideCenterInTrack;
  track.style.transition = animate ? 'transform 0.6s cubic-bezier(.4,0,.2,1)' : 'none';
  track.style.transform = `translateX(${offset}px)`;
}

function renderNav() {
  const nav = document.querySelector('.gallery-nav');
  nav.innerHTML = '';
  // Add left spacer
  const leftSpacer = document.createElement('div');
  leftSpacer.style.width = '50vw';
  leftSpacer.style.flexShrink = '0';
  nav.appendChild(leftSpacer);

  slides.forEach((slide, idx) => {
    const btn = document.createElement('button');
    btn.className = 'gallery-nav-btn' + (idx === current ? ' active' : '');
    btn.textContent = slide.year;
    btn.addEventListener('click', () => {
      goToSlide(idx, true);
    });
    nav.appendChild(btn);
  });

  // Add right spacer
  const rightSpacer = document.createElement('div');
  rightSpacer.style.width = '50vw';
  rightSpacer.style.flexShrink = '0';
  nav.appendChild(rightSpacer);
}

function centerActiveNavBtn() {
  const nav = document.querySelector('.gallery-nav');
  const activeBtn = nav.querySelector('.gallery-nav-btn.active');
  if (!activeBtn) return;
  const btnCenter = activeBtn.offsetLeft + (activeBtn.offsetWidth / 2);
  const navCenter = nav.clientWidth / 2;
  nav.scrollTo({
    left: btnCenter - navCenter,
    behavior: 'smooth'
  });
}

function goToSlide(idx, animate = true) {
  if (idx === current) return;
  current = idx;
  updateCarousel(animate);
  renderNav();
  centerActiveNavBtn();
}

// Keyboard navigation
window.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowLeft') {
    if (current > 0) goToSlide(current - 1, true);
  } else if (e.key === 'ArrowRight') {
    if (current < slides.length - 1) goToSlide(current + 1, true);
  }
});

// Initial render
renderSlides();
renderNav();
centerActiveNavBtn();
document.querySelector('.gallery-nav').scrollLeft = 0;

function ensureCenteredAfterMediaLoad() {
  const track = document.querySelector('.carousel-track');
  const slidesEls = Array.from(track.children);
  let pending = 0;
  slidesEls.forEach(slideDiv => {
    const media = slideDiv.querySelector('img, video');
    if (media) {
      if (media.complete || media.readyState === 4) {
        // Already loaded
      } else {
        pending++;
        media.addEventListener('load', () => {
          pending--;
          if (pending === 0) updateCarousel(false);
        });
        media.addEventListener('loadeddata', () => {
          pending--;
          if (pending === 0) updateCarousel(false);
        });
      }
    }
  });
  // Fallback: always call after a short delay
  setTimeout(() => updateCarousel(false), 100);
}

window.addEventListener('resize', () => updateCarousel(false));
ensureCenteredAfterMediaLoad();

// Time and theme logic (unchanged)
function updateTime() {
  const el = document.getElementById('gallery-time');
  const now = new Date();
  el.textContent = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
}
setInterval(updateTime, 1000);
updateTime();

const lightBtn = document.getElementById('light-toggle');
const darkBtn = document.getElementById('dark-toggle');
lightBtn.addEventListener('click', () => {
  document.body.classList.remove('dark');
  lightBtn.classList.add('active');
  darkBtn.classList.remove('active');
});
darkBtn.addEventListener('click', () => {
  document.body.classList.add('dark');
  darkBtn.classList.add('active');
  lightBtn.classList.remove('active');
});

document.getElementById('about-link').addEventListener('click', function(e) {
  e.preventDefault();
  var modal = document.getElementById('about-modal');
  modal.style.display = 'flex';
  // Force reflow for transition
  void modal.offsetWidth;
  modal.classList.add('open');
});
document.getElementById('about-close').addEventListener('click', function() {
  var modal = document.getElementById('about-modal');
  modal.classList.remove('open');
  setTimeout(function() { modal.style.display = 'none'; }, 350);
});
document.getElementById('about-modal').addEventListener('click', function(e) {
  if (e.target === this) {
    this.classList.remove('open');
    var modal = this;
    setTimeout(function() { modal.style.display = 'none'; }, 350);
  }
});
document.getElementById('about-modal-content').addEventListener('click', function(e) {
  e.stopPropagation();
});
window.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    var modal = document.getElementById('about-modal');
    modal.classList.remove('open');
    setTimeout(function() { modal.style.display = 'none'; }, 350);
  }
});

document.querySelector('.carousel-arrow.left').addEventListener('click', function() {
  if (current > 0) goToSlide(current - 1, true);
});
document.querySelector('.carousel-arrow.right').addEventListener('click', function() {
  if (current < slides.length - 1) goToSlide(current + 1, true);
});

const viewport = document.querySelector('.carousel-viewport');
viewport.addEventListener('mousemove', function(e) {
  const rect = viewport.getBoundingClientRect();
  if (e.clientX - rect.left < rect.width / 2) {
    viewport.classList.add('left-hover');
    viewport.classList.remove('right-hover');
  } else {
    viewport.classList.add('right-hover');
    viewport.classList.remove('left-hover');
  }
});
viewport.addEventListener('mouseleave', function() {
  viewport.classList.remove('left-hover', 'right-hover');
});
viewport.addEventListener('click', function(e) {
  const rect = viewport.getBoundingClientRect();
  if (e.clientX - rect.left < rect.width / 2) {
    // Left half: previous slide
    if (current > 0) goToSlide(current - 1, true);
  } else {
    // Right half: next slide
    if (current < slides.length - 1) goToSlide(current + 1, true);
  }
});
  </script>
</body>
</html>
